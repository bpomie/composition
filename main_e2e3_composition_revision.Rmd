---
title: "Main analyses E2-3. Language processing reveals conceptual combination in preverbal infants"
author: "BP"
output: html_document
---

```{r}
library(readxl)
library(tidyverse)
library(ggpubr)
library(rstatix)
library(scales)
library(lsr)
library(ggdist)
library(tidyquant)
library(gghalves)
```

# DATA

## Paths

```{r warning=FALSE}
home_dir <- Sys.getenv("HOME") #("USERPROFILE")
path <- file.path(home_dir, "Documents", "GitHub", "composition", "data")
pathresults <- file.path(home_dir, "Documents", "GitHub", "composition", "results")
pathplots <- file.path(home_dir, "Documents", "GitHub", "composition", "plots")
```

Load composition data from E2, E3.

```{r}
setwd(path) # Set the path
load("dataattendteste2e3.RData") # Load the raw data
```

Load kind-recognition results.
```{r}
setwd(pathresults) 
load("resultskindrecognition.RData") 
```

```{r}
dnumber <- dcompose %>%
  mutate(single = ifelse(targetnumeral == "single",tghit+dtnumhit,dtkindhit+dtkunrelatedhit),
         pair = ifelse(targetnumeral == "pair",tghit+dtnumhit,dtkindhit+dtkunrelatedhit))
```


```{r}
head(dcompose)
```


# RESULTS

Compute the proportion of looking at each potential referent / AOI (target, number distractor, kind distractor, unrelated/mixed distractor).

```{r}
resultscompose <- dcompose %>%
  group_by(experiment,ID,trial,phase,targetnumeral,validTrial) %>%
  summarise(tg = sum(tghit,na.rm=T),
            dtnum = sum(dtnumhit,na.rm=T),
            dtkind = sum(dtkindhit,na.rm=T),
            dtunrel = sum(dtkunrelatedhit,na.rm=T),
            ct = sum(centerhit,na.rm=T),
            ptg = tg/(tg+dtnum+dtkind+dtunrel),
            pnum = dtnum/(tg+dtnum+dtkind+dtunrel),
            pkind = dtkind/(tg+dtnum+dtkind+dtunrel),
            punrel = dtunrel/(tg+dtnum+dtkind+dtunrel)) %>%
  select(ID,trial,phase,targetnumeral,ptg,pnum,pkind,punrel,validTrial) %>%
  pivot_wider(names_from=phase,values_from=c("ptg","pnum","pkind","punrel")) %>%
  mutate(corrtg=ptg_test-ptg_pretest) %>%
  mutate(corrnum=pnum_test-pnum_pretest) %>%
  mutate(corrkind=pkind_test-pkind_pretest) %>%
  mutate(corrunrel=punrel_test-punrel_pretest)

head(resultscompose)
```

```{r}
# Combine w/ kind info
aux <- merge(resultscompose,resultskindindm,by=c("experiment","ID"))
```

```{r}
resultscompose <- aux
rm(aux)
```


# STATS

## Descriptive overall

### Individual means

```{r}
# Individual means ====
resultscomposeAVE <- resultscompose %>%
  filter(validTrial == 1) %>%
  group_by(experiment,ID,kindknower,mcorrptl) %>%
  summarise(mpretg = mean(ptg_pretest,na.rm=T),
            mprenum = mean(pnum_pretest,na.rm=T),
            mprekind = mean(pkind_pretest,na.rm=T),
            mpreun = mean(punrel_pretest,na.rm=T),
            mtesttg = mean(ptg_test,na.rm=T),
            mtestnum = mean(pnum_test,na.rm=T),
            mtestkind = mean(pkind_test,na.rm=T),
            mtestun = mean(punrel_test,na.rm=T),
            mcorrtg = mean(corrtg,na.rm=T),
            mcorrnum = mean(corrnum,na.rm=T),
            mcorrkind = mean(corrkind,na.rm=T),
            mcorrun = mean(corrunrel,na.rm=T),
            trialcount = n()) 
```

### Group means

```{r}
resultscomposeAVE %>%
  gather(key="aoi",value="mcorr",c("mpretg","mprenum","mprekind","mpreun")) %>%
  filter(kindknower == 1) %>%
  group_by(experiment,aoi) %>%
  get_summary_stats(mcorr, type = "mean_se")

resultscomposeAVE %>%
  gather(key="aoi",value="mcorr",c("mcorrtg","mcorrnum","mcorrkind","mcorrun")) %>%
  filter(kindknower == 1) %>%
  group_by(experiment,aoi) %>%
  get_summary_stats(mcorr, type = "mean_sd")
```


## Descriptive split by numeral

### Individual means

```{r}
# Individual means ====
resultscomposeAVE_splitNumeral <- resultscompose %>%
  filter(validTrial == 1) %>%
  group_by(experiment,ID,kindknower,mcorrptl,targetnumeral) %>%
  summarise(mpretg = mean(ptg_pretest,na.rm=T),
            mprenum = mean(pnum_pretest,na.rm=T),
            mprekind = mean(pkind_pretest,na.rm=T),
            mpreun = mean(punrel_pretest,na.rm=T),
            mtesttg = mean(ptg_test,na.rm=T),
            mtestnum = mean(pnum_test,na.rm=T),
            mtestkind = mean(pkind_test,na.rm=T),
            mtestun = mean(punrel_test,na.rm=T),
            mcorrtg = mean(corrtg,na.rm=T),
            mcorrnum = mean(corrnum,na.rm=T),
            mcorrkind = mean(corrkind,na.rm=T),
            mcorrun = mean(corrunrel,na.rm=T),
            trialcount = n()) 
```

### Group means

```{r}
resultscomposeAVE_splitNumeral %>%
  gather(key="aoi",value="mcorr",c("mpretg","mprenum","mprekind","mpreun")) %>%
  filter(kindknower == 1) %>%
  group_by(experiment,aoi,targetnumeral) %>%
  get_summary_stats(mcorr, type = "mean_se")

resultscomposeAVE_splitNumeral %>%
  gather(key="aoi",value="mcorr",c("mcorrtg","mcorrnum","mcorrkind","mcorrun")) %>%
  filter(kindknower == 1) %>%
  group_by(experiment,aoi,targetnumeral) %>%
  get_summary_stats(mcorr, type = "mean_sd")
```

## Normality

```{r}
aux = resultscomposeAVE %>%filter(kindknower==1)
```

### E2

```{r}
shapiro.test(aux$mcorrtg[aux$experiment=="Experiment 2"])
shapiro.test(aux$mcorrnum[aux$experiment=="Experiment 2"])
shapiro.test(aux$mcorrkind[aux$experiment=="Experiment 2"])
shapiro.test(aux$mcorrun[aux$experiment=="Experiment 2"])
```

### E3

```{r}
shapiro.test(aux$mcorrtg[aux$experiment=="Experiment 3"])
shapiro.test(aux$mcorrnum[aux$experiment=="Experiment 3"])
shapiro.test(aux$mcorrkind[aux$experiment=="Experiment 3"])
shapiro.test(aux$mcorrun[aux$experiment=="Experiment 3"])
```

## Main inferential

### E2

```{r}
t.test(aux$mcorrtg[aux$experiment=="Experiment 2"], mu = 0, alternative = "two.sided")
cohensD(aux$mcorrtg[aux$experiment=="Experiment 2"], mu = 0)
t.test(aux$mcorrkind[aux$experiment=="Experiment 2"], mu = 0, alternative = "two.sided")
cohensD(aux$mcorrkind[aux$experiment=="Experiment 2"], mu = 0)
t.test(aux$mcorrnum[aux$experiment=="Experiment 2"], mu = 0, alternative = "two.sided")
cohensD(aux$mcorrnum[aux$experiment=="Experiment 2"], mu = 0)
t.test(aux$mcorrun[aux$experiment=="Experiment 2"], mu = 0, alternative = "two.sided")
cohensD(aux$mcorrun[aux$experiment=="Experiment 2"], mu = 0)
```

```{r}
t.test(aux$mcorrtg[aux$experiment=="Experiment 2"], aux$mcorrkind[aux$experiment=="Experiment 2"], alternative = "two.sided",paired=T)
cohensD(aux$mcorrtg[aux$experiment=="Experiment 2"], aux$mcorrkind[aux$experiment=="Experiment 2"])
t.test(aux$mcorrtg[aux$experiment=="Experiment 2"], aux$mcorrnum[aux$experiment=="Experiment 2"], alternative = "two.sided",paired=T)
cohensD(aux$mcorrtg[aux$experiment=="Experiment 2"], aux$mcorrnum[aux$experiment=="Experiment 2"])
t.test(aux$mcorrtg[aux$experiment=="Experiment 2"], aux$mcorrun[aux$experiment=="Experiment 2"], alternative = "two.sided",paired=T)
cohensD(aux$mcorrtg[aux$experiment=="Experiment 2"], aux$mcorrun[aux$experiment=="Experiment 2"])
```

#### Multiple-comparison corrections

```{r}
e2tg <- aux$mcorrtg[aux$experiment=="Experiment 2"]
e2kind <- aux$mcorrkind[aux$experiment=="Experiment 2"]
e2num <- aux$mcorrnum[aux$experiment=="Experiment 2"]
e2unrel <- aux$mcorrun[aux$experiment=="Experiment 2"]
```

```{r}
multcomp <- aux %>% gather(key="aoi",value="corr",c("mcorrtg","mcorrnum","mcorrkind","mcorrun")) %>%
  filter(experiment == "Experiment 2") %>%
  convert_as_factor(aoi, ID) %>%
  select(experiment, ID,aoi,corr)
```
```{r}
comparisons <- list(c("mcorrtg", "mcorrnum"), 
                    c("mcorrtg", "mcorrkind"), 
                    c("mcorrtg", "mcorrun"))
```


```{r}
stat.test <- multcomp %>%
  group_by(experiment) %>%
  pairwise_t_test(
    corr ~ aoi, paired = TRUE, 
    p.adjust.method = "bonferroni",
    comparisons = comparisons
    ) #%>% select(-df, -statistic, -p) # Remove details
stat.test
```

### E3

```{r}
t.test(aux$mcorrtg[aux$experiment=="Experiment 3"], mu = 0, alternative = "two.sided")
cohensD(aux$mcorrtg[aux$experiment=="Experiment 3"], mu = 0)
t.test(aux$mcorrnum[aux$experiment=="Experiment 3"], mu = 0, alternative = "two.sided")
cohensD(aux$mcorrnum[aux$experiment=="Experiment 3"], mu = 0)
t.test(aux$mcorrkind[aux$experiment=="Experiment 3"], mu = 0, alternative = "two.sided")
cohensD(aux$mcorrkind[aux$experiment=="Experiment 3"], mu = 0)
t.test(aux$mcorrun[aux$experiment=="Experiment 3"], mu = 0, alternative = "two.sided")
cohensD(aux$mcorrun[aux$experiment=="Experiment 3"], mu = 0)
```


```{r}
t.test(aux$mcorrtg[aux$experiment=="Experiment 3"], aux$mcorrnum[aux$experiment=="Experiment 3"], alternative = "two.sided",paired=T)
cohensD(aux$mcorrtg[aux$experiment=="Experiment 3"], aux$mcorrnum[aux$experiment=="Experiment 3"])
t.test(aux$mcorrtg[aux$experiment=="Experiment 3"], aux$mcorrkind[aux$experiment=="Experiment 3"], alternative = "two.sided",paired=T)
cohensD(aux$mcorrtg[aux$experiment=="Experiment 3"], aux$mcorrkind[aux$experiment=="Experiment 3"])
t.test(aux$mcorrtg[aux$experiment=="Experiment 3"], aux$mcorrun[aux$experiment=="Experiment 3"], alternative = "two.sided",paired=T)
cohensD(aux$mcorrtg[aux$experiment=="Experiment 3"], aux$mcorrun[aux$experiment=="Experiment 3"])
```

### Binomial

Experiment 2.
```{r}
binom.test(16,20, p = 0.5, alternative = "two.sided", conf.level = 0.95)
```

Experiment 3.
```{r}
binom.test(15,20, p = 0.5, alternative = "two.sided", conf.level = 0.95)
```

## Exploratory

### All participants

```{r}
t.test(resultscombinedindm$mcorrtg[resultscombinedindm$experiment=="Experiment 2"], mu = 0, alternative = "two.sided")
cohensD(resultscombinedindm$mcorrtg[resultscombinedindm$experiment=="Experiment 2"], mu = 0)
t.test(resultscombinedindm$mcorrkind[resultscombinedindm$experiment=="Experiment 2"], mu = 0, alternative = "two.sided")
cohensD(resultscombinedindm$mcorrkind[resultscombinedindm$experiment=="Experiment 2"], mu = 0)
t.test(resultscombinedindm$mcorrnum[resultscombinedindm$experiment=="Experiment 2"], mu = 0, alternative = "two.sided")
cohensD(resultscombinedindm$mcorrnum[resultscombinedindm$experiment=="Experiment 2"], mu = 0)
t.test(resultscombinedindm$mcorrun[resultscombinedindm$experiment=="Experiment 2"], mu = 0, alternative = "two.sided")
cohensD(resultscombinedindm$mcorrun[resultscombinedindm$experiment=="Experiment 2"], mu = 0)
```

```{r}
t.test(resultscombinedindm$mcorrtg[resultscombinedindm$experiment=="Experiment 3"], mu = 0, alternative = "two.sided")
cohensD(resultscombinedindm$mcorrtg[resultscombinedindm$experiment=="Experiment 3"], mu = 0)
t.test(resultscombinedindm$mcorrkind[resultscombinedindm$experiment=="Experiment 3"], mu = 0, alternative = "two.sided")
cohensD(resultscombinedindm$mcorrkind[resultscombinedindm$experiment=="Experiment 3"], mu = 0)
t.test(resultscombinedindm$mcorrnum[resultscombinedindm$experiment=="Experiment 3"], mu = 0, alternative = "two.sided")
cohensD(resultscombinedindm$mcorrnum[resultscombinedindm$experiment=="Experiment 3"], mu = 0)
t.test(resultscombinedindm$mcorrun[resultscombinedindm$experiment=="Experiment 3"], mu = 0, alternative = "two.sided")
cohensD(resultscombinedindm$mcorrun[resultscombinedindm$experiment=="Experiment 3"], mu = 0)
```

### Baseline looking

Experiment 2.
```{r}
t.test(aux$mpretg[aux$experiment=="Experiment 2"], mu = .25, alternative = "two.sided")
t.test(aux$mprenum[aux$experiment=="Experiment 2"], mu = .25, alternative = "two.sided")
t.test(aux$mprekind[aux$experiment=="Experiment 2"], mu = .25, alternative = "two.sided")
t.test(aux$mpreun[aux$experiment=="Experiment 2"], mu = .25, alternative = "two.sided")
```

Experiment 3.
```{r}
t.test(aux$mpretg[aux$experiment=="Experiment 3"], mu = .25, alternative = "two.sided")
t.test(aux$mprenum[aux$experiment=="Experiment 3"], mu = .25, alternative = "two.sided")
t.test(aux$mprekind[aux$experiment=="Experiment 3"], mu = .25, alternative = "two.sided")
t.test(aux$mpreun[aux$experiment=="Experiment 3"], mu = .25, alternative = "two.sided")
```
```{r}
```

# PLOTS

```{r}
cbp1 <- c("#CC79A7", "#E69F00", "#0072B2", "#999999",
          "#F0E442", "#0072B2", "#E69F00", "#CC79A7")

cbp2 <- c("#CC79A7", "#E69F00", "#0072B2", "#F0E442",
          "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```



## BOXPLOTS

Prepare E2/E3 data for making the box plots.

```{r}
boxplotE2 <- resultscomposeAVE %>%
  filter(kindknower == 1) %>%
  filter(experiment == "Experiment 2") %>%
  gather(key="aoi",value="corr",c("mcorrtg","mcorrnum","mcorrkind","mcorrun")) %>%
  mutate(aoi = recode(aoi,"mcorrtg" = "target","mcorrkind" = "kind distractor","mcorrnum" = "number distractor", "mcorrun" = "unrelated distractor"),
         aoi = factor(aoi, levels = c("target","kind distractor","number distractor","unrelated distractor")))

boxplotE3 <- resultscomposeAVE %>%
  filter(kindknower == 1) %>%
  filter(experiment == "Experiment 3") %>%
  gather(key="aoi",value="corr",c("mcorrtg","mcorrnum","mcorrkind","mcorrun")) %>%
  mutate(aoi = recode(aoi,"mcorrtg" = "target","mcorrkind" = "kind distractor","mcorrnum" = "number distractor", "mcorrun" = "mixed distractor"),
         aoi = factor(aoi, levels = c("target","kind distractor","number distractor","mixed distractor")))

boxplot_numeral <- resultscomposeAVE_splitNumeral %>%
  gather(key="aoi",value="corr",c("mcorrtg","mcorrnum","mcorrkind","mcorrun")) %>%
  mutate(aoi = recode(aoi,"mcorrtg" = "aTG","mcorrkind" = "dtkind","mcorrnum" = "dtnum"))
```

### Overall

```{r}
e2 <- boxplotE3 %>%
  ggplot(aes(x=as.factor(aoi),y=corr,fill=aoi,color = aoi)) +
  theme_pubr() +
  theme(legend.position = "none",
        title = element_text(size = 16),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_blank(),
        axis.title.y = element_blank()) +
  geom_hline(yintercept = 0, size = .5, lty = "longdash", color = "gray") +
  geom_boxplot(outlier.shape = NA, alpha = 1, width = .35, color = "black", size = .15,
               position=position_dodge2(padding=.1)) +
  geom_point(size = .75, alpha = .55, position = position_jitter(width = .1), color = "black") +
  ylim(-.56,.56) +
  stat_summary(fun.y = mean, na.rm = TRUE,
               geom = "point", color = "white", 
               size = 2, shape = "circle") +
  #labs(title = "Experiment 2", subtitle = "Composition test") +
  scale_colour_manual(values=cbp2) +
  scale_fill_manual(values=cbp2)

e2
```

```{r}
setwd(pathplots) 
  ggsave("boxe3.png", plot = last_plot(), width = 7.5, height = 7.5, units = c("cm"))
```

### Single

```{r}
i1 <- boxplot_numeral %>%
  filter(targetnumeral == "single") %>%
  filter(kindknower == 1) %>%
  filter(experiment == "Experiment 2") %>%
  ggplot(aes(x=as.factor(aoi),y=corr,fill=aoi,color = aoi)) +
  theme_pubr() +
  theme(legend.position = "none",
        title = element_text(size = 18),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 20),
        axis.title.x = element_blank(),
        axis.title.y = element_blank()) +
  geom_hline(yintercept = 0, size = .5, lty = "longdash", color = "gray") +
  geom_boxplot(outlier.shape = NA, alpha = .35, width = .4, color = "black", size = .15) +
  geom_point(size = .75, alpha = .75, position = position_jitterdodge(.15), color = "gray30") +
  ylim(-.56,.56) +
  labs(title = "One") +
  scale_colour_manual(values=cbp1) +
  scale_fill_manual(values=cbp1) 
```

### Pair

```{r}
i2 <- boxplot_numeral %>%
  filter(targetnumeral == "pair") %>%
  filter(kindknower == 1) %>%
  filter(experiment == "Experiment 2") %>%
  ggplot(aes(x=as.factor(aoi),y=corr,fill=aoi,color = aoi)) +
  theme_pubr() +
  theme(legend.position = "none",
        title = element_text(size = 18),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 12, color = "white"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank()) +
  geom_hline(yintercept = 0, size = .5, lty = "longdash", color = "gray") +
  geom_boxplot(outlier.shape = NA, alpha = .35, width = .4, color = "black", size = .15) +
  geom_point(size = .75, alpha = .65, position = position_jitterdodge(.15), color = "gray30") +
  ylim(-.56,.56) +
  labs(title = "Two") +
  scale_colour_manual(values=cbp1) +
  scale_fill_manual(values=cbp1) 
```

### Combine

```{r}
ggarrange(i1,i2,nrow=1)
```


```{r}
setwd(pathplots) 
  ggsave("boxe2Num.png", plot = last_plot(), width = 16, height = 8, units = c("cm"))
```

```{r}
setwd(pathplots) 
ggsave("boxe3_combined.png", plot = last_plot(), width = 10, height = 10, units = c("cm"))
```

## Time-course plots

```{r}
dctime <- merge(dcompose,resultscompose,by=c("experiment","ID","trial","targetnumeral","validTrial"))
```

```{r}
dctime %>%
  filter(validTrial == 1) %>%
  filter(experiment == "Experiment 2") %>%
  mutate(ptg = tghit/(tghit+dtnumhit+dtkindhit+dtkunrelatedhit)) %>%
  mutate(pnum = dtnumhit/(tghit+dtnumhit+dtkindhit+dtkunrelatedhit)) %>%
  mutate(pkind = dtkindhit/(tghit+dtnumhit+dtkindhit+dtkunrelatedhit)) %>%
  mutate(corrtg = ptg-ptg_pretest) %>%
  mutate(corrnum = pnum-pnum_pretest) %>%
  mutate(corrkind = pkind-pkind_pretest) %>%
  group_by(ID,phase,sample,kindknower) %>%
  summarise(tcorrptl = mean(corrtg,na.rm=T),
            tcorrn = mean(corrnum,na.rm=T),
            tcorrk = mean(corrkind,na.rm=T)) %>%
  group_by(phase,sample,kindknower) %>%
  summarise(tcorrtg = mean(tcorrptl,na.rm=T),
            tcorrn = mean(tcorrn,na.rm=T),
            tcorrk = mean(tcorrk,na.rm=T)) %>%
  gather(key="aoi",value = "corr",c("tcorrtg","tcorrn","tcorrk")) %>%
  ggplot(aes(x=sample,y=corr,color=aoi)) +
  geom_line() +
  ylim(-.5,.5) +
  facet_wrap(phase ~ kindknower)
```

#### Baseline-corrected plots.
```{r}
aux <- dctime %>%
  ungroup() %>%
  filter(validTrial == 1) %>%
  filter(phase == "test")

l = nrow(aux)

auxctime <- dctime %>%
  filter(validTrial == 1) %>%
  filter(phase == "test") %>%
  mutate(samplegroup = rep(1:130,each=3,l/390))%>%
  mutate(sumaoi=tghit+dtnumhit+dtkindhit+dtkunrelatedhit) %>%
  mutate(ptg = tghit/sumaoi) %>%
  mutate(pnum = dtnumhit/sumaoi) %>%
  mutate(pkind = dtkindhit/sumaoi) %>%
  mutate(punrel = dtkunrelatedhit/sumaoi) %>%
  mutate(corrtg = ptg-ptg_pretest) %>%
  mutate(corrnum = pnum-pnum_pretest) %>%
  mutate(corrkind = pkind-pkind_pretest) %>%
  mutate(corrunrel = punrel-punrel_pretest) %>%
  group_by(experiment,kindknower,ID,samplegroup) %>%
  summarise(tcorrptl = mean(corrtg,na.rm=T),
            tcorrn = mean(corrnum,na.rm=T),
            tcorrk = mean(corrkind,na.rm=T),
            tcorru = mean(corrunrel,na.rm=T)) %>%
  gather(key="aoi",value = "corr",c("tcorrptl","tcorrn","tcorrk","tcorru")) %>%
  mutate(aoi = factor(aoi, levels = c("tcorrptl","tcorrn","tcorrk","tcorru"))) %>%
  group_by(experiment,kindknower,samplegroup,aoi) %>%
  get_summary_stats(corr, type="mean_se")
```


```{r}
auxctime %>%
  filter(experiment == "Experiment 3") %>%
  filter(kindknower == 1) %>%
  ggplot(aes(x=samplegroup,y=mean,color=aoi,fill = aoi)) +
  theme_pubr() +
  theme(legend.position = "none",
        title = element_text(size = 16),
        axis.text.x = element_text(size = 14),
        axis.text.y = element_text(size = 16),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_blank()) +
  geom_vline(xintercept = 30, size=.15, color="black") +
  geom_vline(xintercept = 240/390*130, size=.15, color="black") +
  geom_hline(yintercept = 0, size=.15, color="black") +
  geom_ribbon(aes(ymin = mean-se, ymax = mean+se),alpha=.15,size = 0) +
  geom_line(size = .75) +
  ylim(-.56,.56) +
  xlab("Time (seconds)") +
  scale_x_continuous(
    breaks = c(1,61/390*130,121/390*130,181/390*130,241/390*130,301/390*130,360/390*130),
                     labels = c("0","1", "2", "3", "4", "5","6")) +
  scale_colour_manual(values=cbp2) +
  scale_fill_manual(values=cbp2)
```

```{r}
setwd(pathplots) # Set the path
ggsave("timee2.png", plot = last_plot(), width = 15, height = 10, units = c("cm"))
```


```{r}
auxctime %>%
  filter(experiment == "Experiment 3") %>%
  filter(kindknower == 1) %>%
  ggplot(aes(x=samplegroup,y=mean,color=aoi)) +
  theme_pubr() +
  theme(legend.position = "none",
        title = element_text(size = 16),
        axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_blank()) +
  geom_vline(xintercept = 30, size=.15, color="black") +
  geom_vline(xintercept = 240/390*130, size=.15, color="black") +
  geom_hline(yintercept = 0, size=.15, color="black") +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se),alpha=.25) +
  geom_line() +
  ylim(-.56,.56) +
  xlab("Time (seconds)") +
  scale_x_continuous(
    breaks = c(1,61/390*130,121/390*130,181/390*130,241/390*130,301/390*130,360/390*130),
                     labels = c("0","1", "2", "3", "4", "5","6")) +
  scale_colour_manual(values=cbp2)

setwd("~/Documents/GitHub/composition/plots/") # Set the path
ggsave("timee3.png", plot = last_plot(), width = 10, height = 8, units = c("cm"))
```

#### Baseline-corrected plots / Individual
```{r}
aux <- dctime %>%
  ungroup() %>%
  filter(atttrial == 1) %>%
  filter(phase == "test")

l = nrow(aux)

auxctime <- dctime %>%
  filter(atttrial == 1) %>%
  filter(phase == "test") %>%
  #mutate(samplegroup = rep(1:130,each=3,l/390))%>%
  mutate(sumaoi=tghit+dtnumhit+dtkindhit+dtkunrelatedhit) %>%
  mutate(ptg = tghit/sumaoi) %>%
  mutate(pnum = dtnumhit/sumaoi) %>%
  mutate(pkind = dtkindhit/sumaoi) %>%
  mutate(punrel = dtkunrelatedhit/sumaoi) %>%
  mutate(corrtg = ptg-ptg_pretest) %>%
  mutate(corrnum = pnum-pnum_pretest) %>%
  mutate(corrkind = pkind-pkind_pretest) %>%
  mutate(corrunrel = punrel-punrel_pretest) %>%
  group_by(experiment,kindknower,ID,sample) %>%
  summarise(tcorrptl = mean(corrtg,na.rm=T),
            tcorrn = mean(corrnum,na.rm=T),
            tcorrk = mean(corrkind,na.rm=T),
            tcorru = mean(corrunrel,na.rm=T)) %>%
  gather(key="aoi",value = "corr",c("tcorrptl","tcorrn","tcorrk","tcorru")) %>%
  mutate(aoi = factor(aoi, levels = c("tcorrptl","tcorrn","tcorrk","tcorru"))) 
```
### AOI visits
cbp1 <- c("#CC79A7", "#E69F00", "#0072B2", "#999999"

```{r warning=FALSE}
aux %>%
  filter(kindknower == 1) %>%
  #filter(ID == 14) %>%
  filter(phase == "test") %>%
  filter(experiment == "Experiment 2") %>%
  ggplot(aes(x=sample,y=tghit)) +
  theme_pubr() +
  theme(
    legend.position = "bottom",
    axis.ticks.y = element_blank(),
    axis.text.y = element_blank(),
      axis.title = element_blank()
  ) +
  geom_line(color = "#CC79A7", size = 3) +
  geom_line(aes(y=dtnumhit), color = "#E69F00", size = 3) +
  geom_line(aes(y=dtkindhit), color = "#0072B2", size = 3) +
  geom_line(aes(y=dtkunrelatedhit), color = "gray", size = 3) +
  facet_grid(trial ~ ID) +
  ylim(.9,1.1)
```

%>%
  ggplot(aes(x=sample,y=tghit)) +
  theme_pubr() +
  theme(
    legend.position = "bottom",
    axis.ticks.y = element_blank()
  ) +
  geom_line(color = "#CC79A7", size = 3) +
  geom_line(aes(y=dtnumhit), color = "blue", size = 3) +
  geom_line(aes(y=dtkindhit), color = "yellow", size = 3) +
  geom_line(aes(y=dtkunrelatedhit), color = "green", size = 3) +
  facet_grid(trial ~ ID) +
  ylim(.9,4.1)

```{r}
aux %>%
  filter(kindknower == 1) %>%
  #filter(ID == 1) %>%
  filter(phase == "test") %>%
  filter(experiment == "Experiment 2") %>%
  group_by(ID,sample) %>%
  mutate(stghit = sum(tghit,na.rm = T)/sum(tghit,dtnumhit,dtkindhit,dtkunrelatedhit,na.rm=T)) %>%
  group_by(ID,sample) %>%
  summarise(mtglook = mean(stghit, na.rm = T)) %>%
  distinct(mtglook)
```

```{r}
auxcomp <- aux %>%
  filter(kindknower == 1) %>%
  #filter(ID == 1) %>%
  filter(phase == "test") %>%
  filter(experiment == "Experiment 2") %>%
  group_by(ID,sample) %>%
  mutate(stghit = sum(tghit,na.rm = T)/sum(tghit,dtnumhit,dtkindhit,dtkunrelatedhit,na.rm=T)) %>%
  group_by(ID,sample) %>%
  summarise(mtglook = mean(stghit, na.rm = T))
```
%>%
  ggplot(aes(x=sample,y=ID_Number,fill=as.factor(mtglook))) +
    theme_pubr() +
     theme(
      axis.ticks.y = element_blank()
    ) +
  geom_tile() + 
  scale_fill_manual(values = c("1"= "#6c294e",
                               "0.75" = "#b34481",
                               "0.67" = "#c15d94",
                               "0.5"= "#cc79a7",
                               "0.33" = "#dca4c3",
                               "0.25" = "gold",
                               "0" = "#fff09d",
                               "NaN" = "white"))

```{r}
b <- aux %>%
  filter(kindknower == 1) %>%
  #filter(ID == 4) %>%
  filter(phase == "test") %>%
  filter(experiment == "Experiment 2") %>%
  group_by(ID,sample) %>%
  mutate(stghit = sum(dtkindhit,na.rm = T)/sum(tghit,dtnumhit,dtkindhit,dtkunrelatedhit,na.rm=T)) %>%
  group_by(ID,sample) %>%
  summarise(mtglook = mean(stghit, na.rm = T)) %>%
  #group_by(sample) %>%
  #mutate(mtglook = mean(mtglook, na.rm = T)) %>%
  mutate(mtglook = round(mtglook,2)) %>%
  ungroup() %>%
  mutate(ID_Number = dense_rank(ID)) %>%
  ggplot(aes(x=sample,y=ID_Number,fill=as.factor(mtglook))) +
    theme_pubr() +
     theme(
      axis.ticks.y = element_blank(),
      axis.text.y = element_blank(),
      axis.title = element_blank()
    ) +
  geom_tile() + 
  scale_fill_manual(values = c("1"= "#6c294e",
                               "0.75" = "#b34481",
                               "0.67" = "#c15d94",
                               "0.5"= "#cc79a7",
                               "0.33" = "#dca4c3",
                               "0.25" = "gray60",
                               "0" = "gray90",
                               "NaN" = "white"))
b
```

```{r}
ggarrange(b,a,ncol = 1)
```

```{r}
setwd("~/Documents/GitHub/composition/plots/") # Set the path
ggsave("timee3.png", plot = last_plot(), width = 20, height = 8, units = c("cm"))
```


```{r}
aux %>%
  filter(kindknower == 1) %>%
  #filter(ID == 1) %>%
  filter(phase == "test") %>%
  filter(experiment == "Experiment 2") %>%
  group_by(ID,sample,trial) %>%
  mutate(stghit = sum(tghit)/sum(tghit,dtnumhit,dtkindhit,dtkunrelatedhit)) %>%
  ggplot(aes(x=sample,y=ID,fill=as.factor(stghit))) +
    theme_pubr() +
     theme(
      axis.ticks.y = element_blank()
    ) +
  geom_tile() + #color="white",size=.25
  scale_fill_manual(values=rev(c("white","#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4", "#ddf1da")), labels = c("1","0.75","0.5","0.25"))
```



```{r}
auxctime %>%
  filter(experiment == "Experiment 2") %>%
  filter(kindknower == 1) %>%
  #filter(ID == 1) %>%
  ggplot(aes(x=sample,y=corr,color=aoi)) +
  theme_pubr() +
  theme(legend.position = "bottom",
        title = element_text(size = 16),
        axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_blank()) +
  geom_vline(xintercept = 30, size=.15, color="black") +
  geom_vline(xintercept = 240/390*130, size=.15, color="black") +
  geom_hline(yintercept = 0, size=.15, color="black") +
  #geom_errorbar(aes(ymin = mean-se, ymax = mean+se),alpha=.25) +
  geom_line() +
  ylim(-.56,.56) +
  xlab("Time (seconds)") +
  #scale_x_continuous(
  #  breaks = c(1,61/390*130,121/390*130,181/390*130,241/390*130,301/390*130,360/390*130),
  #                   labels = c("0","1", "2", "3", "4", "5","6")) +
  scale_colour_manual(values=cbp2) +
  facet_wrap(. ~ ID)

#setwd("~/Documents/GitHub/composition/plots/") # Set the path
#ggsave("timee2.png", plot = last_plot(), width = 10, height = 8, units = c("cm"))
```



```{r}
auxctime %>%
  filter(experiment == "Experiment 3") %>%
  filter(kindknower == 1) %>%
  ggplot(aes(x=samplegroup,y=mean,color=aoi)) +
  theme_pubr() +
  theme(legend.position = "none",
        title = element_text(size = 16),
        axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        axis.title.x = element_text(size = 14),
        axis.title.y = element_blank()) +
  geom_vline(xintercept = 30, size=.15, color="black") +
  geom_vline(xintercept = 240/390*130, size=.15, color="black") +
  geom_hline(yintercept = 0, size=.15, color="black") +
  geom_errorbar(aes(ymin = mean-se, ymax = mean+se),alpha=.25) +
  geom_line() +
  ylim(-.56,.56) +
  xlab("Time (seconds)") +
  scale_x_continuous(
    breaks = c(1,61/390*130,121/390*130,181/390*130,241/390*130,301/390*130,360/390*130),
                     labels = c("0","1", "2", "3", "4", "5","6")) +
  scale_colour_manual(values=cbp2)

setwd("~/Documents/GitHub/composition/plots/") # Set the path
ggsave("timee3.png", plot = last_plot(), width = 10, height = 8, units = c("cm"))
```



# REVIEW: RAW LTimes

```{r}
rawdata <- dcompose %>%
  filter(validTrial == 1) %>%
  group_by(experiment,ID,trial,phase,targetnumeral) %>%
  summarise(sumtg = sum(tghit,na.rm=T)*1000/60/1000,
            sumdtnum = sum(dtnumhit,na.rm=T)*1000/60/1000,
            sumdtkind = sum(dtkindhit,na.rm=T)*1000/60/1000,
            sumdtunrel = sum(dtkunrelatedhit,na.rm=T)*1000/60/1000,
            sumct = sum(centerhit,na.rm=T))%>%
  select(ID,trial,phase,targetnumeral,sumtg,sumdtnum,sumdtkind,sumdtunrel)
```

```{r}
# Combine w/ kind info
aux <- merge(rawdata,resultskindindm,by=c("experiment","ID")) %>%
  filter(kindknower == 1) %>%
  mutate(sumtotal = sumtg+sumdtnum + sumdtkind + sumdtunrel)

View(aux)
```

```{r}
aux %>%
  filter(kindknower == 1) %>%
  filter(experiment == "Experiment 2") %>%
  mutate(phase = recode(phase, "pretest" = "baseline", "test" = "response")) %>%
  group_by(ID,phase) %>%
  summarise(msumtg = mean(sumtg,na.rm=T),
            msumdtnum = mean(sumdtnum,na.rm=T),
            msumdtkind = mean(sumdtkind,na.rm=T),
            msumdtunrel = mean(sumdtunrel,na.rm=T)) %>%
  group_by(phase) %>%
  summarise(tg = mean(msumtg),
            num = mean(msumdtnum),
            kind = mean(msumdtkind),
            unrel = mean(msumdtunrel)) %>%
  mutate(pkind = kind/(tg+num+kind+unrel),
         pnum = num/(tg+num+kind+unrel))
```


## by Referent

```{r}
e2b <- aux %>%
  filter(kindknower == 1) %>%
  filter(experiment == "Experiment 2") %>%
  mutate(phase = recode(phase, "pretest" = "baseline", "test" = "response")) %>%
  group_by(ID,phase) %>%
  summarise(msumtg = mean(sumtg,na.rm=T),
            msumdtnum = mean(sumdtnum,na.rm=T),
            msumdtkind = mean(sumdtkind,na.rm=T),
            msumdtunrel = mean(sumdtunrel,na.rm=T),
            n()) %>%
  gather(key="aoi",value="value",c("msumtg","msumdtkind","msumdtnum","msumdtunrel")) %>%
  mutate(aoi = factor(aoi, levels = c("msumtg","msumdtkind","msumdtnum","msumdtunrel"))) %>%
  ggplot(aes(x = as.factor(phase), y = value, fill = aoi, color = aoi)) +
  theme_pubr() +
  theme(legend.position = "none",
        axis.title = element_blank(),
        axis.text.y = element_text(size = 16),
        axis.text.x = element_text(size = 12),
        title = element_text(size = 18),
        panel.background = element_rect(fill = 'white')) +
  geom_jitter(position=position_jitterdodge(.35), size = 1, alpha = .25) +
  stat_summary(fun.y = mean, na.rm = TRUE,
               geom = "point",
               #color = "gray40", 
               size = 2, shape = "circle",position=position_dodge(width = .75)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE,
               #color = "gray40", 
               size = .5, position=position_dodge(width = .75),geom = "errorbar", width = 0) +
  scale_color_manual(values=cbp1) +
  scale_fill_manual(values=cbp1) +
  ylim(0,3.15) +
  ggtitle("Experiment 2")

e3b <- aux %>%
  filter(experiment == "Experiment 3") %>%
  mutate(phase = recode(phase, "pretest" = "baseline", "test" = "response")) %>%
  group_by(ID,phase) %>%
  summarise(msumtg = mean(sumtg,na.rm=T),
            msumdtnum = mean(sumdtnum,na.rm=T),
            msumdtkind = mean(sumdtkind,na.rm=T),
            msumdtunrel = mean(sumdtunrel,na.rm=T),
            n()) %>%
  gather(key="aoi",value="value",c("msumtg","msumdtnum","msumdtkind","msumdtunrel")) %>%
  mutate(aoi = factor(aoi, levels = c("msumtg","msumdtnum","msumdtkind","msumdtunrel"))) %>%
  ggplot(aes(x = as.factor(phase), y = value, fill = aoi, color = aoi)) +
  theme_pubr() +
  theme(legend.position = "none",
        axis.title = element_blank(),
        axis.text.y = element_text(size = 16),
        axis.text.x = element_text(size = 12),
        title = element_text(size = 18),
        panel.background = element_rect(fill = 'white')) +
  geom_jitter(position=position_jitterdodge(.35), size = 1, alpha = .25) +
  stat_summary(fun.y = mean, na.rm = TRUE,
               geom = "point",
               #color = "gray40", 
               size = 2, shape = "circle",position=position_dodge(width = .75)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE,
               #color = "gray40", 
               size = .5, position=position_dodge(width = .75),geom = "errorbar", width = 0) +
  scale_color_manual(values=cbp1) +
  scale_fill_manual(values=cbp1) +
  ylim(0,3.15) +
  ggtitle("Experiment 3")

```

```{r}
  ggarrange(e2b,e2b,e3b, nrow = 1, widths = c(1,1.5,1.5))
```

```{r}
setwd(pathplots)
ggsave("baseline_raw_byaoi.png", plot = last_plot(), width = 20, height = 8, units = c("cm"))
```

```{r}
aux %>%
  ungroup() %>%
  mutate(ptg = sumtg/(sumtg + sumdtnum + sumdtkind + sumdtunrel)) %>%
  filter(ID == 1) %>%
  group_by(experiment,ID,phase) %>%
  mutate(mptg = mean(ptg))
```


#### By number

```{r}
aux <- dnumber %>%
  group_by(experiment,ID,trial,phase,attpretest,atttest,atttrial) %>%
  summarise(sumsingle = sum(single,na.rm=T)*1000/60/1000,
            sumpair = sum(pair,na.rm=T)*1000/60/1000)%>%
  select(ID,trial,phase,sumsingle,sumpair,
         attpretest,atttest,atttrial)
```

```{r}
# Combine w/ kind info
resultsnumberplot <- merge(aux,resultskindindm,by=c("experiment","ID"))
```

```{r}
resultsnumberplot %>%
  filter(kindknower == 1) %>%
  filter(atttrial == 1) %>%
  filter(experiment == "Experiment 3") %>%
  group_by(ID,phase) %>%
  summarise(msumsingle = mean(sumsingle,na.rm=T),
            msumpair = mean(sumpair,na.rm=T),
            n()) 
```

ˆ

```{r}
e2rc <- resultsnumberplot %>%
  filter(kindknower == 1) %>%
  filter(atttrial == 1) %>%
  filter(experiment == "Experiment 2") %>%
  group_by(ID,phase) %>%
  summarise(msumsingle = mean(sumsingle,na.rm=T),
            msumpair = mean(sumpair,na.rm=T),
            n()) %>%
  gather(key="numeral",value="value",c("msumsingle","msumpair")) %>%
  mutate(aoi = factor(numeral, levels = c("msumsingle","msumpair"))) %>%
  ggplot(aes(x = as.factor(phase), y = value, fill = numeral, color = numeral)) +
  theme_pubr() +
  theme(legend.position = "none",
        axis.title = element_blank(),
        axis.text = element_text(size = 12)) +
  geom_jitter(position=position_jitterdodge(.2), size = .96, alpha = .65) +
  stat_summary(fun.y = mean, na.rm = TRUE,
               geom = "point",
               color = "black", 
               size = 2, shape = "circle",position=position_dodge(width = .75)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE,
               color = "black", 
               size = .5, position=position_dodge(width = .75),geom = "errorbar", width = 0) +
  scale_color_manual(values=c("red3","purple")) +
  ylim(0,3.15) + 
  ggtitle("Experiment 2")

e3rc <- resultsnumberplot %>%
  filter(kindknower == 1) %>%
  filter(atttrial == 1) %>%
  filter(experiment == "Experiment 3") %>%
  group_by(ID,phase) %>%
  summarise(msumsingle = mean(sumsingle,na.rm=T),
            msumpair = mean(sumpair,na.rm=T),
            n()) %>%
  gather(key="numeral",value="value",c("msumsingle","msumpair")) %>%
  mutate(aoi = factor(numeral, levels = c("msumsingle","msumpair"))) %>%
  ggplot(aes(x = as.factor(phase), y = value, fill = numeral, color = numeral)) +
  theme_pubr() +
  theme(legend.position = "none",
        axis.title = element_blank(),
        axis.text = element_text(size = 12),
        title = element_text(size = 14)) +
  geom_jitter(position=position_jitterdodge(.2), size = .96, alpha = .65) +
  stat_summary(fun.y = mean, na.rm = TRUE,
               geom = "point",
               color = "black", 
               size = 2, shape = "circle",position=position_dodge(width = .75)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE,
               color = "black", 
               size = .5, position=position_dodge(width = .75),geom = "errorbar", width = 0) +
  scale_color_manual(values=c("red3","purple")) +
  ylim(0,3.15) + 
  ggtitle("Experiment 3")
```


#### Combine plots

```{r}
  ggarrange(e1b,e2b,e3b, nrow = 1, widths = c(1,1.5,1.5))
```

```{r}
setwd(pathplots)
ggsave("baseline_raw_byaoi.png", plot = last_plot(), width = 20, height = 8, units = c("cm"))
```

```{r}
ggarrange(e1rc,e2rc,e3rc, nrow = 1)
#annotate_figure(figure, top = text_grob("Raw looking time split by cardinality"))
```

 
```{r}
setwd(pathplots)
ggsave("rawe3.png", plot = last_plot(), width = 15, height = 8, units = c("cm"))
```

## corrpl

```{r}
plotcorr <- resultscomposeAVE %>%
  gather(key="aoi",value="value",c("mpretg","mprenum","mprekind","mpreun",
                                     "mtesttg","mtestnum","mtestkind","mtestun",
                                   "mcorrtg","mcorrnum","mcorrkind","mcorrun")) %>%
  select(experiment, ID, kindknower, aoi, value) %>%
  mutate(measure = case_when(
    str_detect(aoi, "pre") ~ "baseline",
    str_detect(aoi, "test") ~ "response",
    str_detect(aoi, "corr") ~ "Baseline corrected")) %>%
  mutate(measure = factor(measure, levels = c("baseline","response","Baseline corrected"))) %>%
  mutate(aoi = case_when(
    str_detect(aoi, "tg") ~ "Target",
    str_detect(aoi, "kind") ~ "Kind Distractor",
    str_detect(aoi, "num") ~ "Number Distractor",
    str_detect(aoi, "un") ~ "Unrelated/Mixed Distractor"
    )) %>%
  mutate(aoi = factor(aoi, levels = c("Target","Kind Distractor","Number Distractor","Unrelated/Mixed Distractor"))) 
```


```{r}
plotcorr %>% 
  filter(kindknower == 1) %>%
  group_by(experiment, kindknower,measure,aoi) %>%
  summarise(mvalue = mean(value))
```


```{r}
e2corr <- plotcorr %>%
  filter(kindknower == 1) %>%
  filter(measure != "Baseline corrected") %>%
  filter(experiment == "Experiment 2") %>%
  ggplot(aes(x=as.factor(measure),y=value,fill=as.factor(aoi),color = as.factor(aoi))) +
  theme_pubr() +
  theme(legend.position = "none",
        axis.title = element_blank(),
        axis.text.y = element_text(size = 16),
        axis.text.x = element_text(size = 12),
        title = element_text(size = 10)) +
  geom_jitter(position=position_jitterdodge(.35), size = .96, alpha = .25) +
  stat_summary(fun.y = mean, na.rm = TRUE,
               geom = "point",
               #color = "black", 
               size = 2, shape = "circle",position=position_dodge(width = .75)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE,
               #color = "black", 
               size = .65, position=position_dodge(width = .75),geom = "errorbar", width = 0) +
  geom_hline(yintercept = 0.25, size = .25, lty = "longdash", color = "darkred") +
  ylim(0,0.8) +
  scale_colour_manual(values=cbp1)

e3corr <- plotcorr %>%
  filter(kindknower == 1) %>%
  filter(measure != "Baseline corrected") %>%
  filter(experiment == "Experiment 3") %>%
  ggplot(aes(x=as.factor(measure),y=value,fill=as.factor(aoi),color = as.factor(aoi))) +
  theme_pubr() +
  theme(legend.position = "none",
        axis.title = element_blank(),
        axis.text.y = element_text(size = 16),
        axis.text.x = element_text(size = 12),
        title = element_text(size = 10)) +
  geom_jitter(position=position_jitterdodge(.35), size = .96, alpha = .25) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE,
               #color = "black", 
               size = .65, position=position_dodge(width = .75),geom = "errorbar", width = 0) +
  stat_summary(fun.y = mean, na.rm = TRUE,
               geom = "point",
               #color = "black", 
               size = 2, shape = "circle",position=position_dodge(width = .75)) +
  geom_hline(yintercept = 0.25, size = .25, lty = "longdash", color = "darkred") +
  ylim(0,0.8) +
  scale_colour_manual(values=cbp1) 
```


```{r}
plotcorr %>% 
  filter(kindknower == 1) %>%
  group_by(experiment, kindknower,measure,aoi) %>%
  summarise(mvalue = mean(value))
```

```{r}
ggarrange(e2b,e2corr, nrow = 2)
```

```{r}
setwd(pathplots)
ggsave("pl2.png", plot = last_plot(), width = 7.5, height = 15, units = c("cm"))
```

```{r}
ggarrange(e3b,e3corr, nrow = 2)
```


```{r}
setwd(pathplots)
ggsave("pl3.png", plot = last_plot(), width = 7.5, height = 15, units = c("cm"))
```

# SAVE

```{r}
setwd("~/Documents/GitHub/composition/results/") # Set the path
save(resultsindm, file = "resultse2e3.RData")
```
